<!doctype html>
<html lang=" en-US ">

<head>
    <meta charset="utf-8">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=88e715cdd6e0bd047c7d68b39d123a466842e492">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

</head>

<body>
    <div id="header">
        <nav>
    <li><a href="/search" title="search">&#x1F50D;</a></li>
    <!--
    <li><a href="#sytwstoc" title="Table of Contents">‚â°</a></li>
    -->

      
    <li><a href="/practicas/09p9-t2-promise-readfile.html" title="Previous">&#x2190;</a></li>
    
    
    <li><a href="/practicas/13p12-t2-promise-allsettled.html" title="Next">&#x2192;</a></li>
    
    <li><a href="https://github.com/ULL-MII-SYTWS-1920/ull-mii-sytws-1920.github.io/tree/master//_practicas/10p10-t2-promise-all.md" title="Edit this page at GitHub">üêô</a>
    
    <li><a href="/references.html" title="Bibliograf√≠a">&#x1f4da</a></li>
    <li><a href="/practicas.html" title="Pr√°cticas">&#x270d</a></li>
    
    <li><a href="/clases.html" title="Clases">üë®‚Äçüè´</a></li>

    <li><a href="/" title="Home page">&#x1f3e0</a></li>
    <li><a href="/tema0-presentacion/" title="Tema 0: Presentaci√≥n">0</a></li>
    <li><a href="/tema1-introduccion/" title="Tema 1: Introducci√≥n">1</a></li>
    <li><a href="/tema2-async/" title="Tema 2: Async">2</a></li>
    <li><a href="/tema3-web/" title="Tema 3: Web">3</a></li>
    <li><a href="/tema4-devops/" title="Tema 4: Devop">4</a></li>
    
</nav>

    </div>
    <!-- end header -->


    <div class="wrapper">

        <section>
            
<div id="title">
        <h1>Sistemas y Tecnolog√≠as Web: Servidor</h1>
        <p> Master de II. ULL. 1er cuatrimestre. 2020/2021</p>
        <hr>
        <span class="credits left">Organization <a href="https://github.com/ULL-MII-SYTWS-2021" target="_blank">ULL-MII-SYTWS-2021</a></span>
        <span class="credits left"> &nbsp; Classroom <a href="https://classroom.github.com/classrooms/68184806-ull-mii-sytws-2021" target="_blank">ULL-MII-SYTWS-2021</a></span>
        <span class="credits left"> &nbsp; Campus Virtual <a href="https://campusdoctoradoyposgrado.ull.es/course/view.php?id=2020111300" target="_blank">SYTWS</a></span>
        <span class="credits left"> &nbsp; Chat <a href="https://chat.google.com/u/1/room/AAAAp18fCE8" target="_blank">Chat</a></span>
        <span class="credits left"> &nbsp; Profesor <a href="https://www.ull.es/apps/guias/guias/view_teacher_niu/745/(%3FPcrguezl.*)/" target="_blank">Casiano</a></span>
    </div>

<!--

<div id="title">
    <h1>Sistemas y Tecnolog√≠as Web: Servidor</h1>
    <p> Master de II. ULL. 1er cuatrimestre. 2020/2021</p>
    <hr>
    <span class="credits left">Organization <a href="https://github.com/ULL-MII-SYTWS-1920"
            target="_blank">ULL-MII-SYTWS-1920</a></span>
    <span class="credits left"> &nbsp; Github Classroom <a
            href="https://classroom.github.com/classrooms/55384072-master-de-ingenieria-informatica-sistemas-y-tecnologias-web-servidor-classroom"
            target="_blank">SYTWS 19/20</a></span>
    <span class="credits left"> &nbsp; Campus Virtual <a
            href="https://campusvirtual.ull.es/1920/course/view.php?id=201913778" target="_blank">SYTWS
            19/20</a></span>
    <span class="credits left"> &nbsp; Profesor <a
            href="https://www.ull.es/apps/guias/guias/view_teacher_niu/588/(%3FPcrguezl.*)/"" target="
            _blank">Casiano</a></span>
</div>
-->    

            
            



            <h2 >Table of Contents</h2>
            
            <ul id="sytwstoc">
  <li><a href="#descripci√≥n-de-la-pr√°ctica-p10-t2-promise-all">Descripci√≥n de la Pr√°ctica p10-t2-promise-all</a>
    <ul>
      <li><a href="#hints">Hints</a></li>
      <li><a href="#see">See</a></li>
    </ul>
  </li>
</ul>
          

            <div class="container">
                <h1 id="descripci√≥n-de-la-pr√°ctica-p10-t2-promise-all">Descripci√≥n de la Pr√°ctica p10-t2-promise-all</h1>

<p>Given an array of promises, <code class="language-plaintext highlighter-rouge">Promise.all</code> returns a promise that waits for all of the promises in the array to finish. 
It then succeeds, yielding an array of result values. 
If a promise in the array fails, the promise returned by all fails too, with the failure reason from the failing promise.</p>

<p>Implement something like this yourself as a regular function called <code class="language-plaintext highlighter-rouge">Promise_all</code>.</p>

<p>Remember that after a promise has succeeded or failed, 
it can‚Äôt succeed or fail again, and further calls to the functions that resolve it are ignored. 
This can simplify the way you handle failure of your promise.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"ie=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Promise.all<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Open the Developer tools<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;script&gt;</span>
        <span class="kd">function</span> <span class="nx">Promise_all</span><span class="p">(</span><span class="nx">promises</span><span class="p">)</span> <span class="p">{</span>
           <span class="c1">// Fill the code</span>
        <span class="p">}</span>

        <span class="c1">// Test code.</span>
        <span class="nx">Promise_all</span><span class="p">([]).</span><span class="nx">then</span><span class="p">(</span><span class="nx">array</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This should be []:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">array</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="kd">function</span> <span class="nx">soon</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">val</span><span class="p">),</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">500</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="nx">Promise_all</span><span class="p">([</span><span class="nx">soon</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nx">soon</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nx">soon</span><span class="p">(</span><span class="mi">3</span><span class="p">)]).</span><span class="nx">then</span><span class="p">(</span><span class="nx">array</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This should be [1, 2, 3]:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">array</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">Promise_all</span><span class="p">([</span><span class="nx">soon</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nx">soon</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nx">soon</span><span class="p">(</span><span class="dl">"</span><span class="s2">a</span><span class="dl">"</span><span class="p">)]).</span><span class="nx">then</span><span class="p">(</span><span class="nx">array</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This should be [5, 2, "a"]:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">array</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">Promise_all</span><span class="p">([</span><span class="nx">soon</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">),</span> <span class="nx">soon</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">array</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">We should not get here</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">X</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Rejection correctly managed!</span><span class="dl">'</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">else</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Unexpected failure:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
            <span class="p">});</span>

        <span class="nx">Promise_all</span><span class="p">([</span>
            <span class="nx">soon</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="k">new</span> <span class="nb">Promise</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="k">throw</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Muerto!</span><span class="dl">'</span><span class="p">))</span> <span class="p">}),</span>
            <span class="nx">soon</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">])</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">array</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">We should not get here</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="sr">/Muerto!/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Exception correctly managed!:</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">});</span>        
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="hints">Hints</h2>

<p>The function passed to the <code class="language-plaintext highlighter-rouge">Promise</code> constructor will have to call then on each of the promises in the given array. 
When one of them succeeds, two things need to happen. 
The resulting value needs to be stored in the correct position of a result array, and 
we must check whether this was the last pending promise and finish our own promise if it was.</p>

<p>The latter can be done with a counter that is initialized to the length of the input array and from which we subtract 1 every time a promise succeeds. 
When it reaches 0, we are done. 
Make sure you take into account the situation where the input array is empty (and thus no promise will ever resolve).</p>

<p>Handling failure requires some thought but turns out to be extremely simple. Just pass the reject function of the wrapping promise to each of the promises in the array as a catch handler or as a second argument to then so that a failure in one of them triggers the rejection of the whole wrapper promise.</p>

<h2 id="see">See</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">tema2-async/practicas/p10-t2-promise-all/</code></li>
  <li>This lab is duplicated at <a href="/tema2-async/practicas/p3-t2-handling-events/reto2.html">Reto 1: Building Promise.all</a></li>
</ul>


            </div>
                        <details>
                <summary><h2>Comment with GitHub Utterances</h2></summary>
                <script src="https://utteranc.es/client.js"
        repo="ULL-MII-SYTWS-1920/ull-mii-sytws-1920.github.io"
        issue-term="pathname"
        label="SYTWS"
        theme="dark-blue"
        crossorigin="anonymous"
        async>
</script>
            </details>
            
            <details>
                <summary>
                   <h2>Comment with Disqus</h2> 
                </summary>              
                



<div id="disqus_thread">
    thread de discusion
</div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: 
EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: 
       https://disqus.com/admin/universalcode/#configuration-variables*/

/*
var disqus_config = function () {
   this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
   this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://https-ull-mii-sytws-1920-github-io.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
   (d.head || d.body).appendChild(s);
})();

</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            

 

            </details>
        </section>
    
    </div>


    
</body>

</html>
