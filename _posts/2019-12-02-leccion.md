---
layout: post
title:  "Clase del Lunes 02/12/2019"
categories: Clases
---

# Clase del Lunes 02/12/2019

## Jekyll

Recuerda que GitHub provee un servicio de Hosting de páginas estáticas ([GitHub Pages](https://pages.github.com/)) que se sirven mediante Jekyll.

En las prácticas que siguen, práctica a usar Jekyll desplegando el proyecto en GitHub Pages.

For more details, see [section Jekyll]({{site.baseurl}}/tema3-web/jekyyl) 

### Exercise: Adding a Simple Search to our Jekyll Site

El ejercicio consiste en añadir la capacidad de búsqueda en el sitio.
Estos son algunos requisitos:

* Queremos que busque en todos los ficheros, no solo los  de los posts sino también los de las páginas
* Que admita expresiones regulares
* Queremos que los resultados vayan apareciendo conforme tecleamos

#### ¿Como hacerlo?

1. Since Jekyll has no server side execution, we have to rely on storing all the required content in a single file and search our keyword from that file.
2. We will be creating a JSON file in which we will store page `title`, page `url`, `content`, `excerpt`, etc., <u>at building time</u>

    ```
    usuario@ubuntu ~/src/ull-mii-sytws-1920.github.io (master) $ bundle exec jekyll build
    usuario@ubuntu ~/src/ull-mii-sytws-1920.github.io (master) $ head -n 30 _site/assets/src/search.json 
    ```

    ```json
    [
        {
            "title": "Clase del Lunes 30/09/2019",
            "excerpt": "Clase del Lunes 30/09/2019\n\n",         ⇐ Resumen
            "content": "Clase del Lunes 30/09/2019\n\n\n  ...",  ⇐ Contenido del fichero
            "url": "/clases/2019/09/30/leccion.html"
        },
        ...
    ]
    ```

Para lograrlo usaremos este template:

```json
---
layout: null
sitemap: false
---

{% capture json %}
[
  {% assign collections = site.collections | where_exp:'collection','collection.output != false' %}
  {% for collection in collections %}
    {% assign docs = collection.docs | where_exp:'doc','doc.sitemap != false' %}
    {% for doc in docs %}
      {
        "title": {{ doc.title | jsonify }},
        "excerpt": {{ doc.excerpt | markdownify | strip_html | jsonify }},
        "content": {{ doc.content | markdownify | strip_html | jsonify }},
        "url": {{ site.baseurl | append: doc.url | jsonify }}
      },
    {% endfor %}
  {% endfor %}
  {% assign pages = site.html_pages | where_exp:'doc','doc.sitemap != false' | where_exp:'doc','doc.title != null' %}
  {% for page in pages %}
  {
    "title": {{ page.title | jsonify }},
    "excerpt": {{ page.excerpt | markdownify | strip_html | jsonify }},
    "content": {{ page.content | markdownify | strip_html | jsonify }},
    "url": {{ site.baseurl | append: page.url | jsonify }}
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{% endcapture %}

{{ json | lstrip }}
```

Esta imagen muestra los ficheros implicados en este ejercicio dentro de 
la estructura del sitio de estos apuntes:

```
usuario@ubuntu ~/src/ull-mii-sytws-1920.github.io (master) $ tree -I _site
.
├── 404.md
├── assets
│   ├── css
│   │   └── style.scss
│   ├── images
│   │   ├── event-emitter-methods.png
│   │   └── ,,,
│   └── src
│       ├── fetch.js          ⇐ Polyfill for fetch
│       ├── search.js         ⇐ Librería con la Clase JekyllSearch que implementa el Código de búsqueda
│       └── search.json       ⇐ Plantilla Liquid para generar el fichero JSON 
├── search.md                 ⇐ Página de la búsqueda. Formulario y script de arranque 
├── clases.md
├── _config.yml               ⇐ Fichero de configuración de Jekyll
├── degree.md
├── favicon.ico
├── Gemfile
├── Gemfile.lock
├── _includes                 ⇐ The include tag allows to include the content of files stored here
│   ├── navigation-bar.html
│   └── ...
├── _layouts                  ⇐ templates that wrap around your content
│   ├── default.html
│   ├── error.html
│   └── post.html
├── _posts                    ⇐ File names must follow YEAR-MONTH-DAY-title.MARKUP and  must begin with front matter 
│   ├── ...
│   └── 2019-12-02-leccion.md
├── _practicas                ⇐ Folder for the collection "practicas" (list of published "practicas") 
│   ├── ...
│   └── p9-t3-transfoming-data.md 
├── practicas.md              ⇐ { % for practica in site.practicas % } ... { % endfor % }
├── Rakefile                  ⇐ For tasks
├── README.md
├── references.md
├── resources.md
├── tema0-presentacion        ⇐  Pages folders 
│   ├── README.md
│   └── ...
├── tema ...
├── tfa
│   └── README.md
└── timetables.md

58 directories, 219 files
```

#### Fetch Polyfill

<dl>
<dt>Polyfill</dt>
<dd>
<a href="https://developer.mozilla.org/en-US/docs/Glossary/Polyfill">A polyfill is a piece of code (usually JavaScript on the Web) used to provide modern functionality on older browsers that do not natively support it. The polyfill uses non-standard features in a certain browser to give JavaScript a standards-complaint way to access the feature</a>
</dd>
</dl>

* El código del polyfill que he usado: [assets/src/fetch.js](https://github.com/ULL-MII-SYTWS-1920/ull-mii-sytws-1920.github.io/blob/master/assets/src/fetch.js)
* Para mas información podemos leer este blog: [Polyfill para Fetch](https://desarrolloweb.com/articulos/polyfill-fetch.html)
  - [whatwg-fetch: polyfill de Fetch que ha creado el equipo de Github](https://github.com/github/fetch) 
  - Para agregar este polyfill a nuestro proyecto podemos descargarnos su archivo js desde github, 
  - pero también podríamos instalarlo usando cualquiera de los gestores de dependencias más habituales: 
  - `npm install whatwg-fetch --save` 
  - o bien: 
  - `bower install fetch --save`


### Referencias

* [Liquid](https://shopify.github.io/liquid/)
* [A GitHub Pages compatible **Table of Contents** generator without a plugin or JavaScript ](https://github.com/allejo/jekyll-toc) The code is here: [toc.html](https://github.com/allejo/jekyll-toc/blob/master/_includes/toc.html)
* [CloudCannon](https://app.cloudcannon.com/) is cloud content management system and hosting provider for Jekyll websites
* [documentation-theme-jekyll](https://github.com/ULL-MII-SYTWS-1920/documentation-theme-jekyll) Un tema muy completo. Tiene de todo
* [Using HTMLProofer From Ruby and Travis](https://github.com/gjtorikian/html-proofer/wiki/Using-HTMLProofer-From-Ruby-and-Travis). Para testear tus páginas: links, imágenes, etc.

## [Gastby](gatsby)

Gatsby is a React-based, GraphQL powered, static site generator. 

## Práctica p8-t3-jekyll-netlify

* Práctica [p8-t3-jekyll-netlify](/tema3-web/practicas/p8-t3-jekyll-netlify/)

